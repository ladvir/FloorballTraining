@using FloorballTraining.WebApp.Pages.Activities
@inject IDialogService DialogService

<MudChip Icon="@Icons.Material.Filled.Draw" Variant="Variant.Outlined" OnClick="OpenDrawingDialog" Color="Color.Warning">Kreslit</MudChip>


@code {

    [Parameter]
    public string DrawingAsJson { get; set; } = string.Empty;

    [Parameter]
    public EventCallback<string> OnDrawingChanged { get; set; }

    private async Task OpenDrawingDialog()
    {
        var options = new DialogOptions
        {
            NoHeader = true,
            CloseOnEscapeKey = true,
            CloseButton = false,
            DisableBackdropClick = true,
            Position = DialogPosition.Center,
            MaxWidth = MaxWidth.ExtraExtraLarge,
            FullWidth = true,
            FullScreen = false
        };

        var parameters = new DialogParameters();
        parameters.Add("DrawingAsJson", DrawingAsJson);
        var dialog = await DialogService.ShowAsync<DrawingModal>("Kreslení", parameters, options);

        var result = await dialog.Result;

        if (result == DialogResult.Cancel())
        {
            return;
        }


        if (result.Data == null) return;

        DrawingAsJson = result.Data.ToString() ?? string.Empty;

        

        await OnDrawingChanged.InvokeAsync();
    }

}
