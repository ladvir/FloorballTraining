@inject IViewPlaceByNameUseCase ViewPlaceByNameUse

<MudChip Icon="@Icons.Material.Filled.SelectAll" Color="Color.Success" OnClick="SelectAll">Vše</MudChip>
<MudChip Icon="@Icons.Material.Filled.Deselect" Color="Color.Success" OnClick="DeselectAll">Nic</MudChip>

<MudPaper Elevation="0" Class="d-inline-flex flex-wrap my-2 align-items-start">
    @foreach (var place in _places)
    {
        <MudCheckBox T="bool" Color="Color.Success" Class="mr-4 d-inline-flex flex-wrap" Size="Size.Small" Style="vertical-align: middle;"
                     Dense="true" CheckedChanged="() => CheckboxChanged(place)">@place.Name
            
    </MudCheckBox>
    }
</MudPaper>


@code {

    [Parameter]
    public List<Place>? SelectedValues { get; set; } = new();

    [Parameter]
    public EventCallback<List<Place>> SelectedValuesChanged { get; set; }

    private IEnumerable<Place> _places = new List<Place>();

    private readonly List<Place> _selectedValues = new();

    protected override async Task OnInitializedAsync()
    {
        if (SelectedValues != null && SelectedValues.Any())
            foreach (var item in SelectedValues)
            {
                _selectedValues.Add(item);
            }

        _places = await ViewPlaceByNameUse.ExecuteAsync();
    }

    private bool IsChecked(long placeId)
    {
        return _selectedValues.Exists(s => s.Id == placeId);
    }

    private async Task CheckboxChanged(Place value)
    {
        if (_selectedValues.Contains(value))
        {
            _selectedValues.Remove(value);
        }
        else
        {
                _selectedValues.Add(value);
        }
        

        await SelectedValuesChanged.InvokeAsync(_selectedValues);
    }

    private async Task SelectAll()
    {
        foreach (var place in _places)
        {
            if (!_selectedValues.Contains(place)) _selectedValues.Add(place);
        }
        await SelectedValuesChanged.InvokeAsync(_selectedValues);
    }

    private async Task DeselectAll()
    {
       _selectedValues.Clear();
        await SelectedValuesChanged.InvokeAsync(_selectedValues);
    }

}





    

