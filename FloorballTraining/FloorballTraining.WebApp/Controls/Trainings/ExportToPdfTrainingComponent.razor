@inject ICreateTrainingPdfUseCase CreateTrainingPdfUseCase
@inject IJSRuntime JSRuntime


<MudChip Disabled="@Disabled" Icon="@Icons.Material.Filled.PictureAsPdf" Variant="Variant.Outlined" Color="Color.Success" OnClick="ExportToPdf">PDF</MudChip>

@code {

    [Parameter]
    public Training Training { get; set; } = new();

    [Parameter]
    public bool Disabled { get; set; } = false;


    private async Task ExportToPdf()
    {
        var pdf = await CreateTrainingPdfUseCase.ExecuteAsync(Training.TrainingId);

        await DownloadPdf(Training.Name, pdf);

    }

    private async Task DownloadPdf(string trainingName, byte[]? content)
    {

        var fileName = trainingName.Replace(" ", "") + ".pdf";


        fileName = Path.GetInvalidFileNameChars().Aggregate(fileName, (current, c) => current.Replace(c, '_'));

        await JSRuntime.InvokeVoidAsync("saveFileAsPdf", fileName, content);

    }
}