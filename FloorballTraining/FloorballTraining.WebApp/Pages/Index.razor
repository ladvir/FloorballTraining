@page "/"
@using FloorballTraining.UseCases
@inject IViewActivityByNameUseCase ViewActivityByNameUseCase
@inject IViewActivityByCriteriaUseCase ViewActivityByCriteriaUseCase
@inject AppSettings AppSettings

<SearchActivityComponent ActivitySearchCriteria="@_activitySearchCriteria" DurationMax="AppSettings.MaxActivityDuration" PersonsMax="@AppSettings.MaximalPersons" OnSearchItem="Search" />
<ActivitySelectionListComponent ActivitySearchCriteria="@_activitySearchCriteria" SelectedActivities="@_selectedActivities?.ToList()" />

@code {
    ActivitySearchCriteria? _activitySearchCriteria ;
    IEnumerable<Activity>? _selectedActivities ;

    protected override async Task OnInitializedAsync()
    {
        _activitySearchCriteria = new ActivitySearchCriteria
        {
            PersonsMin = 15,
            PersonsMax = 19
        };

        await Search(_activitySearchCriteria);
    }

    private async Task Search(ActivitySearchCriteria arg)
    {
        _selectedActivities = await ViewActivityByCriteriaUseCase.ExecuteAsync(arg);
        _activitySearchCriteria = arg;
    }
}