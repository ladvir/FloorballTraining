@page "/activities"
@using FloorballTraining.UseCases
@inject AppSettings AppSettings
@inject IViewActivityByCriteriaUseCase ViewActivityByCriteriaUseCase

<MudText Typo="Typo.h4">Aktivity</MudText>
<SearchActivityComponent ActivitySearchCriteria="@_activitySearchCriteria" DurationMax="AppSettings.MaxActivityDuration" PersonsMax="@AppSettings.MaximalPersons" OnSearchItem="Search" OnActivityAdded="AddActivityIntoListOfActivities" />
<br/>
<ActivityListComponent Activities="@_activities"  />

@code {
    ActivitySearchCriteria _activitySearchCriteria = new ();
    List<Activity> _activities = new ();

    protected override async Task OnInitializedAsync()
    {
        await SearchByCriteria(_activitySearchCriteria);
    }

    private async Task Search(ActivitySearchCriteria activitySearchCriteria)
    {
        _activitySearchCriteria = activitySearchCriteria;
        await SearchByCriteria(_activitySearchCriteria);
    }

    private async Task SearchByCriteria(ActivitySearchCriteria activitySearchCriteria)
    {
        var result = await ViewActivityByCriteriaUseCase.ExecuteAsync(activitySearchCriteria);
        _activities = result.ToList();
    }

    private void AddActivityIntoListOfActivities(Activity activity)
    {
        _activities.Add(activity);
    }

}
