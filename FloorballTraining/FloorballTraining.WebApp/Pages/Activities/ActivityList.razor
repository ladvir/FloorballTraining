@page "/activities"
@using FloorballTraining.UseCases
@inject AppSettings AppSettings
@inject IViewActivityByCriteriaUseCase ViewActivityByCriteriaUseCase

<MudText Typo="Typo.h4">Aktivity</MudText>
<SearchActivityComponent SearchCriteria="@_SearchCriteria" DurationMax="AppSettings.MaxActivityDuration" PersonsMax="@AppSettings.MaximalPersons" OnSearchItem="Search" OnActivityAdded="AddActivityIntoListOfActivities" />
<br/>
<ActivityListComponent Activities="@_activities"  />

@code {
    SearchCriteria _SearchCriteria = new ();
    List<Activity> _activities = new ();

    protected override async Task OnInitializedAsync()
    {
        await SearchByCriteria(_SearchCriteria);
    }

    private async Task Search(SearchCriteria SearchCriteria)
    {
        _SearchCriteria = SearchCriteria;
        await SearchByCriteria(_SearchCriteria);
    }

    private async Task SearchByCriteria(SearchCriteria SearchCriteria)
    {
        var result = await ViewActivityByCriteriaUseCase.ExecuteAsync(SearchCriteria);
        _activities = result.ToList();
    }

    private void AddActivityIntoListOfActivities(Activity activity)
    {
        _activities.Add(activity);
    }

}
