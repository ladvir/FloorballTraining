@page "/activities"
@using FloorballTraining.UseCases.Activities.Interfaces
@using FloorballTraining.CoreBusiness.Dtos
@inject AppSettings AppSettings
@inject IViewActivitiesUseCase ViewActivitiesUseCase

<MudText Typo="Typo.h4">Aktivity</MudText>
<SearchActivityComponent SearchCriteria="@_searchCriteria" DurationMax="AppSettings.MaxActivityDuration" PersonsMax="@AppSettings.MaximalPersons" OnSearchItem="Search" OnActivityAdded="AddActivityIntoListOfActivities" />
<br/>


    <SendActivityViaEmailComponent ActivityIds="@_selectedActivityIds" />
<ActivityListComponent @ref="_activityListComponent" SearchCriteria="@_searchCriteria" SelectedActivitiesChanged="OnSelectedActivitiesChanged" />


@code {
    SearchCriteria _searchCriteria = new ();
    List<int> _selectedActivityIds = new();

    ActivityListComponent _activityListComponent;

    protected override async Task OnInitializedAsync()
    {
        //await SearchByCriteria(_searchCriteria);
    }

    private async Task Search(SearchCriteria searchCriteria)
    {
        _searchCriteria = searchCriteria;
        await _activityListComponent.SearchByCriteria(searchCriteria);
    }
    
    private void AddActivityIntoListOfActivities(ActivityDto activity)
    {
        //_activities?.Add(activity);
        StateHasChanged();
    }

    private void OnSelectedActivitiesChanged(List<int> selectedActivityIds)
    {
        _selectedActivityIds = selectedActivityIds;
        StateHasChanged();
    }

}
