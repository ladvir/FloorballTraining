@using TrainingDataAccess.Models
@using TrainingCreator.Data
@using TrainingCreator.Pages.Components


<CascadingValue Value="this">
<CascadingValue Value="@SelectedValues">
    <TagTree Tags="@Tags"/>
</CascadingValue>
</CascadingValue>

@code {
    [Parameter]
    public List<Tag> SelectedValues { get; set; } = new List<Tag>();

    [Parameter]
    public List<Tag> Tags { get; set; } = new List<Tag>();

    [Parameter]
    public EventCallback<List<Tag>> SelectedValuesChanged { get; set; }

    public void Refresh(List<Tag> selected)
    {
        SelectedValues = selected;
        StateHasChanged();
        SelectedValuesChanged.InvokeAsync(SelectedValues);
    }

    protected override void OnInitialized()
    {
        SelectedValues = new List<Tag>();
        _ = (TagTreeBuilder.Build(Tags) ?? new List<Tag>()).ToList();
    }
}
