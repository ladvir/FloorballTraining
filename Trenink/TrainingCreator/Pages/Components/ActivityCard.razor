@using TrainingDataAccess.Models
@using TrainingDataAccess.Services.ActivityServices
@inject IDialogService DialogService




<MudCard Elevation="0" Outlined="true" Style="width: 15vw; height: 15vh; overflow-y: hidden; overflow-wrap: break-word ">
    <MudCardHeader Class="ma-1 pa-1">
        @*<CardHeaderAvatar>
                    <MudAvatar Color="Color.Secondary" >I</MudAvatar>
                </CardHeaderAvatar>*@
        <CardHeaderContent >

            
            <ActivityCountersOverview Activity="Activity"/>
        </CardHeaderContent>
        <CardHeaderActions>
            <MudMenu PositionAtCursor="true">
                <ActivatorContent >
                    <MudIconButton Icon="@Icons.Material.Filled.Menu"/>
                </ActivatorContent>
                <ChildContent>
                    <MudMenuItem OnClick="ShowDetail">Detail</MudMenuItem>
                    <MudMenuItem OnClick="Edit">Edit</MudMenuItem>
                    <MudMenuItem OnClick="Delete">Delete</MudMenuItem>
                    <MudMenuItem OnClick="Select">Do výběru</MudMenuItem>
                </ChildContent>
            </MudMenu>
        </CardHeaderActions>
    </MudCardHeader>

    <MudCardContent Class="ma-1 pa-1">
        <MudText Typo="Typo.body2" GutterBottom="true" Style="overflow: hidden; height: 5vh" >@Description</MudText>
                
    </MudCardContent>
</MudCard>

@code {

        private const int DescriptionLength = 150;

    [Parameter]
    public ActivityDto Activity { get; set; } = new ActivityDto();

    private string Description
    {
        get
        {
            var descr = Activity.Description;

            return descr.Length >= DescriptionLength ? descr[..(DescriptionLength-3)] + "..." : descr;
        }
    }

    private void ShowDetail()
    {
        var options = new DialogOptions
            {
                NoHeader = false,
                CloseOnEscapeKey = true,
                CloseButton = true,
                DisableBackdropClick = true,
                Position = DialogPosition.Center,
                MaxWidth = MaxWidth.ExtraLarge,
                FullWidth = true,
                FullScreen = false,

            };
        var parameters = new DialogParameters { ["Activity"] = Activity};
        
        DialogService.Show<ActivityDetailReadOnly>(string.Empty, parameters, options);
        
    }

    private void Select()
    {
    }

    private void Edit()
    {

    }

    private void Delete()
    {
    }

}
