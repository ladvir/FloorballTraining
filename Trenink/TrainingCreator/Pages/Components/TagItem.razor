@using System.Text.RegularExpressions
@using TrainingDataAccess.Models

@if (Tag.Children != null && Tag.Children.Any())
{
    <MudListItem Text="@Tag.Name" Style="@($"background-color:{@Tag.Color}; color:white;")" InitiallyExpanded="true">
        <NestedList>
            @foreach (var subTag in Tag.Children)
            {
                <TagItem Tag="@subTag" /> 
            }
        </NestedList>
    </MudListItem>
}
else
{
    <MudListItem Text="@Tag.Name" Value="@Tag.TagId" Style="@($"background-color:{Tag.Color}; color:white;")" OnClick="@(() => OnTagClick(Tag))" InitiallyExpanded="true" />
}

@code {
    [Parameter] public Tag Tag { get; set; } = null!;

    [Parameter]
    public EventCallback<int> Action { get; set; }

    void ToggleTag()
    {
        Tag.IsExpanded = !Tag.IsExpanded;
    }

    private void OnTagClick(Tag tag)
    {
        Action.InvokeAsync(tag.TagId);
    }
}